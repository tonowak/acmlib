\chapter{Wzorki}

\section{Równości}
$x = \frac{-b\pm\sqrt{b^2-4ac}}{2a}$,
Wierzchołek paraboli $= (- \frac{b}{2a}, - \frac{\Delta}{4a})$,
$ax+by=e \wedge cx+dy=f \implies
x=\dfrac{ed-bf}{ad-bc} \wedge y=\dfrac{af-ec}{ad-bc}$.

\section{Pitagoras}
Trójki $(a, b, c)$, takie że $a^2+b^2=c^2$:
 Jest $a=k\cdot (m^{2}-n^{2}),\ \,b=k\cdot (2mn),\ \,c=k\cdot (m^{2}+n^{2}),$
 gdzie $m > n > 0$, $k > 0$, $m \bot n$, oraz albo $m$ albo $n$ jest parzyste.

\section{Generowanie względnie pierwszych par}
Dwa drzewa, zaczynając od $(2, 1)$ (parzysta-nieparzysta) oraz $(3, 1)$ (nieparzysta-nieparzysta), rozgałęzienia są do $(2m-n,m)$, $(2m+n,m)$ oraz $(m+2n,n)$.

\section{Liczby pierwsze}
	$p=962592769$ to liczba na NTT, czyli $2^{21} \mid p-1$. Do hashowania:
	970592641 (31-bit), 31443539979727 (45-bit), 3006703054056749 (52-bit). 
	Jest 78498 pierwszych $\leq$ 1\,000\,000.
	Generatorów jest $\phi(\phi(p^a))$, czyli dla $p>2$ zawsze istnieje.

\section{Liczby antypierwsze}
		\begin{center}
			\begin{tabular}{l}
				\begin{tabular}{c|c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }}
					$lim$  & $10^2$ & $10^3$ & $10^4$ & $10^5$ & $10^6$ & $10^7$ & $10^8$ \\
					\hline
					$n$ & 60 & 840 & 7560 & 83160 & 720720 & 8648640 & 73513440 \\
					\hline
					$d(n)$ & 12 & 32 & 64 & 128 & 240 & 448 & 768 \\
				\end{tabular}\\
				\begin{tabular}{c|c@{\ }c@{\ }c@{\ }c}
					$lim$  & $10^9$ & $10^{12}$  & $10^{15}$ \\
					\hline
					$n$ & 735134400 & 963761198400 & 866421317361600 \\
					\hline
					$d(n)$ & 1344 & 6720 & 26880 \\
				\end{tabular}\\
				\begin{tabular}{c|c@{\ }}
					$lim$  & $10^{18}$\\
					\hline
					$n$ & 897612484786617600\\
					\hline
					$d(n)$ & 103680\\
				\end{tabular}
			\end{tabular}
		\end{center}

\section{Dzielniki}
	$\sum_{d|n} d = O(n \log \log n)$,
	liczba dzielników $n$ jest co najwyżej 100 dla $n < 5e4$, 500 dla $n < 1e7$, 2000 dla $n < 1e10$, 200\,000 dla $n < 1e19$.


\section{Lemat Burnside'a}
	Liczba takich samych obiektów z dokładnością do symetrii wynosi
	% Given a group $G$ of symmetries and a set $X$, the number of elements of $X$ \emph{up to symmetry} equals
	$ {\frac {1}{|G|}}\sum _{{g\in G}}|X^{g}|, $
	gdzie $G$ to zbiór symetrii (ruchów) oraz $X^g$ to punkty (obiekty) stałe symetrii $g$.

\section{Silnia}
		\begin{center}
			\begin{tabular}{l}
				\begin{tabular}{c|c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c}
					$n$  & 1 & 2 & 3 & 4  & 5   & 6   & 7    & 8     & 9      & 10\\
					\hline
					$n!$ & 1 & 2 & 6 & 24 & 120 & 720 & 5040 & 40320 & 362880 & 3628800\\
				\end{tabular}\\
					\begin{tabular}{c|c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c}
					$n$  & 11    & 12    & 13    & 14     & 15     & 16     & 17\\
					\hline
					$n!$ & 4.0e7 & 4.8e8 & 6.2e9 & 8.7e10 & 1.3e12 & 2.1e13 & 3.6e14\\
				\end{tabular}\\
				\begin{tabular}{c|c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c}
					$n$  & 20   & 25   & 30   & 40   & 50   & 100   & 150   & 171\\
					\hline
					$n!$ & 2e18 & 2e25 & 3e32 & 8e47 & 3e64 & 9e157 & 6e262 & \scriptsize{$>$DBL\_MAX}\\
				\end{tabular}
			\end{tabular}
		\end{center}

\section{Symbol Newtona}
		$ \binom{n}{k}=\dfrac{n!}{k!\left(n-k\right)!}=\dfrac{n^{\underline{k}}}{k!}$,
		$ \binom{n}{k}=\binom{n-1}{k-1}+\binom{n-1}{k}=\binom{n-1}{k-1}+\binom{n-2}{k-1}+\dots+\binom{k-1}{k-1}$,
		$ (x+y)^n=\sum_{k=0}^n \binom{n}{k} x^k y^{n-k} $,
		$ \sum_{i=0}^k \binom{n+i}{i} = \binom{n+k+1}{k} $,
		$ \left(-1\right)^i \binom{x}{i} = \binom{i - 1 - x}{i} $,
		$ \sum_{i=0}^k \binom{n}{i} \binom{m}{k - i} = \binom{n + m}{k} $,
		$ \binom{n}{k} \binom{k}{i} = \binom{n}{i} \binom{n - i}{k - i} $.


\section{Wzorki na pewne ciągi}
	\subsection{Nieporządek}
		Liczba takich permutacji, że $p_i \neq i$ (żadna liczba nie wraca na tą samą pozycję):
		$ \mkern-2mu D(n) = (n-1)(D(n-1)+D(n-2)) = n D(n-1)+(-1)^n = \left\lfloor\frac{n!}{e}\right\rceil $

	\subsection{Liczba podziałów}
		Liczba sposobów zapisania $n$ jako sumę posortowanych liczb dodatnich:
		$ p(0) = 1,\ p(n) = \sum_{k \in \mathbb Z \setminus \{0\}}{(-1)^{k+1} p(n - k(3k-1) / 2)} $,
		szacujemy $ p(n) \sim 0.145 / n \cdot \exp(2.56 \sqrt{n}) $.

		\begin{center}
		\begin{tabular}{c|c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c}
			$n$    & 0 & 1 & 2 & 3 & 4 & 5 & 6  & 7  & 8  & 9  & 20  & 50  & 100 \\ \hline
			$p(n)$ & 1 & 1 & 2 & 3 & 5 & 7 & 11 & 15 & 22 & 30 & 627 & $\mathtt{\sim}$2e5 & $\mathtt{\sim}$2e8 \\
		\end{tabular}
		\end{center}

	\subsection{Liczby Eulera pierwszego rzędu}
		Liczba permutacji $\pi \in S_n$ gdzie $k$ elementów jest większych niż poprzedni: $k$ razy $\pi(j)>\pi(j+1)$, $k+1$ razy $\pi(j)\geq j$, $k$ razy $\pi(j)>j$.
		Zachodzi
		$E(n,k) = (n-k)E(n-1,k-1) + (k+1)E(n-1,k)$,
		$E(n,0) = E(n,n-1) = 1$,
		$E(n,k) = \sum_{j=0}^k(-1)^j\binom{n+1}{j}(k+1-j)^n$.

	\subsection{Stirling pierwszego rzędu}
		Liczba permutacji długości $n$ mające $k$ cykli:
			$c(n,k) = c(n-1,k-1) + (n-1) c(n-1,k),\ c(0,0) = 1$,
			$\textstyle \sum_{k=0}^n c(n,k)x^k = x(x+1) \dots (x+n-1)$.
		Małe wartości:
		$c(8,k) = 8, 0, 5040, 13068, 13132, 6769, 1960, 322, 28, 1$,
		$c(n,2) = 0, 0, 1, 3, 11, 50, 274, 1764, 13068, 109584, \dots$.

	\subsection{Stirling drugiego rzędu}
		Liczba podziałów zbioru rozmiaru $n$ na $k$ bloków:
		$S(n,k) = S(n-1,k-1) + k S(n-1,k)$,
		$S(n,1) = S(n,n) = 1$,
		$S(n,k) = \frac{1}{k!}\sum_{j=0}^k (-1)^{k-j}\binom{k}{j}j^n$.

	\subsection{Liczby Catalana}
		$ C_n=\frac{1}{n+1}\binom{2n}{n}= \binom{2n}{n}-\binom{2n}{n+1} = \frac{(2n)!}{(n+1)!n!} $,
		$ C_0=1,\ C_{n+1} = \frac{2(2n+1)}{n+2}C_n,\ C_{n+1}=\sum C_iC_{n-i} $,
		$C_n = 1, 1, 2, 5, 14, 42, 132, 429, 1430, 4862, 16796, 58786, \dots$.

		Równoważne:
			ścieżki na planszy $n\times n$,
			nawiasowania po $n$ (),
			liczba drzew binarnych z $n+1$ liściami (0 lub 2 syny),
			skierowanych drzew z $n+1$ wierzchołkami,
			triangulacje $n+2$-kąta,
			permutacji $[n]$ bez 3-wyrazowego rosnącego podciągu?

	\subsection{Formuła Cayley'a}
		Liczba różnych drzew (z dokładnością do numerowania wierzchołków) wynosi $n^{n-2}$.
		Liczba sposobów by zespójnić $k$ spójnych o rozmiarach $s_1, s_2, \dots, s_k$ wynosi $s_1 \cdot s_2 \cdot \dots \cdot s_k \cdot n^{k-2}$.

	\subsection{Twierdzenie Kirchhoffa}
		Liczba różnych drzew rozpinających spójnego nieskierowanego grafu $G$ bez pętelek (mogą być multikrawędzie) o $n$ wierzchołkach jest równa $\det A_{n-1}$, gdzie $A = D - M$, $D$ to macierz diagonalna mająca na przekątnej stopnie wierzchołków w grafie $G$, $M$ to macierz incydencji grafu $G$, a $A_{n-1}$ to macierz $A$ z usuniętymi ostatnim wierszem oraz ostatnią kolumną.

		\vspace{2em}

\section{Funkcje tworzące}
		$ \dfrac{1}{\left(1-x\right)^k} = \sum_{n\geq 0} \binom{k - 1 + n}{k - 1} x ^ n $,
		$ \exp(x) = \sum_{n\geq 0} \dfrac{x^n}{n!} $,
		$ -\log(1 - x) = \sum_{n\geq 1} \dfrac{x^n}{n} $.

\section{Funkcje multiplikatywne}
			$\epsilon\left(n\right) = [n = 1]$,
			$id_k\left(n\right) = n^k$, $id = id_1$, $\mathbbm{1} = id_0$,
			$\sigma_k\left(n\right) = \sum_{d|n}d^k$, $\sigma = \sigma_1$, $\tau = \sigma_0$,
			$\mu\left(p^k\right) = [k = 0] - [k = 1]$,
			$\varphi\left(p^k\right) = p^k - p^{k - 1}$,
			$\left(f \ast g\right)\left(n\right) = \sum_{d|n}f\left(d\right)g\left(\frac{n}{d}\right)$,
			$f \ast g = g \ast f$,
			$f \ast \left(g \ast h\right) = \left(f \ast g\right) \ast h$,
			$f \ast \left(g + h\right) = f \ast g + f \ast h$,
			jak dwie z trzech funkcji $f \ast g = h$ są multiplikatywne, to trzecia też,
			$f \ast \mathbbm{1} = g \Leftrightarrow g \ast \mu = f$,
			$f \ast \epsilon = f$,
			$\mu \ast \mathbbm{1} = \epsilon$, $[n = 1] = \sum_{d|n}\mu\left(d\right) =\sum_{d=1}^n\mu\left(d\right)[d|n]$,
			$\varphi \ast \mathbbm{1} = id$,
			$id_k \ast \mathbbm{1} = \sigma_k$, $id \ast \mathbbm{1} = \sigma$, $\mathbbm{1} \ast \mathbbm{1} = \tau$,
			$s_f\left(n\right) = \sum_{i=1}^nf\left(i\right)$,
			$s_f\left(n\right) = \frac{s_{f\ast g}\left(n\right) - \sum_{d=2}^n s_f\left(\lfloor\frac{n}{d}\rfloor\right)g\left(d\right)}{g\left(1\right)}$.

\section{Fibonacci}

$F_n = \frac{\left(\frac{1+\sqrt{5}}{2}\right)^n - \left(\frac{1-\sqrt{5}}{2}\right)^n}{\sqrt{5}}$,
$F_{n-1}F_{n+1}-F_n^2=(-1)^n$, $F_{n+k}=F_k F_{n+1} + F_{k-1} F_n$, $F_n | F_{nk}$, $NWD(F_m, F_n) = F_{NWD(m, n)}$

\section{Woodbury matrix identity}

Dla $A\equiv n\times n, C\equiv k\times k, U\equiv n\times k, V\equiv k\times n$
jest $(A+UCV)^{-1} = A^{-1} - A^{-1}U(C^{-1}+VA^{-1}U)^{-1}VA^{-1},$
przy czym często $C=Id$.
Używane gdy $A^{-1}$ jest już policzone i chcemy policzyć odwrotność lekko zmienionego $A$
poprzez $C^{-1}$ i $VA^{-1}U$.
Często występuje w kombinacji z tożsamością $\frac{1}{1-A} = \sum_{i=0}^\infty A^i$.
